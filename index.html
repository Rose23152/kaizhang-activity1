<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é–‹æ¼³è–ç‹æ´»å‹•ç™»éŒ„</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 10px; 
      background: #f5f5f5; 
    }
    .container { 
      max-width: 100%; 
      background: white; 
      padding: 15px; 
      border-radius: 8px; 
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    select, input, button { 
      width: 100%; 
      padding: 12px; 
      margin: 5px 0; 
      border: 1px solid #ddd; 
      border-radius: 5px; 
      font-size: 16px; 
    }
    button { 
      background: #b20d0d; 
      color: white; 
      border: none; 
      font-weight: bold;
    }
    #result { 
      margin-top: 15px; 
      padding: 15px; 
      background: #e8f5e8; 
      border-radius: 5px; 
      display: none; 
      border: 2px solid #4caf50;
    }
    .lottery-number {
      font-size: 24px;
      color: #b20d0d;
      font-weight: bold;
      text-align: center;
      margin: 10px 0;
    }
    .cloud-status {
      font-size: 12px;
      color: #666;
      text-align: center;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2 style="text-align: center; color: #b20d0d;">é–‹æ¼³è–ç‹æ´»å‹•ç™»éŒ„</h2>
    
    <select id="region">
      <option value="">è«‹é¸æ“‡åœ°å€</option>
      <option value="åŸºéš†/å°åŒ—">åŸºéš†/å°åŒ—</option>
      <option value="æ–°åŒ—/æ–°ç«¹">æ–°åŒ—/æ–°ç«¹</option>
      <option value="æ¡ƒåœ’/è‹—æ —">æ¡ƒåœ’/è‹—æ —</option>
      <option value="å°ä¸­/å½°åŒ–">å°ä¸­/å½°åŒ–</option>
      <option value="å—æŠ•/é›²æ—">å—æŠ•/é›²æ—</option>
      <option value="å˜‰ç¾©/å°å—">å˜‰ç¾©/å°å—</option>
      <option value="é«˜é›„/å±æ±/å°æ±">é«˜é›„/å±æ±/å°æ±</option>
      <option value="èŠ±è“®/å®œè˜­">èŠ±è“®/å®œè˜­</option>
    </select>

    <select id="temple">
      <option value="">è«‹å…ˆé¸æ“‡åœ°å€</option>
    </select>

    <input type="text" id="name" placeholder="è«‹è¼¸å…¥å§“å">
    <button onclick="submitForm()">é€å‡ºç™»éŒ„</button>
    
    <div id="result"></div>
  </div>

  <script>
  // é›²ç«¯ç¶²å€
  const CLOUD_URL = 'https://script.google.com/macros/s/AKfycbyZ4dwk6J_gHKjL0Bmsgv8DlCI5qdg2vMWFI-qwpWzWv1P4F2JD3TTW6zUW_iweQS8d7Q/exec';

  // å®Œæ•´çš„å®®å»Ÿè³‡æ–™
  const templeData = {
    "åŸºéš†/å°åŒ—": ["å¥ æ¿Ÿå®®", "å¤§æ­¦å´™å¤§éˆå®®", "å…§æ¹–ç¢§å±±å·–", "å…¬é¤¨æ­¦èº«é–‹æ¼³è–ç‹å»Ÿ", "èŠå±±å·–æƒ æ¿Ÿå®®", "èç¤é–‹æ¼³è–ç‹å®®", "é™½æ˜å±±å¹³ç­‰åˆèª å®®", "çŸ³ç‰Œæ±¾é™½å®®"],
    "æ–°åŒ—/æ–°ç«¹": ["è²¡åœ˜æ³•äººä¸­å’Œå»£æ¿Ÿå®®", "è²¡åœ˜æ³•äººæ–°åº—å¤ªå¹³å®®", "è²¢å¯®æ˜­æƒ å»Ÿ", "é‡‘å±±å»£å®‰å®®", "é‡æŸ³ä¿å®‰å®®", "è¬é‡Œå¿ ç¦å®®", "è¬é‡Œä¿æ°‘å®®", "æ¨¹æ—æ—¨é›²å®®", "æŸ‘æ—å¨æƒ å»Ÿ", "æ–°ç«¹è–ç‹å®®", "èŠæ—ç™¾å£½å®®", "æ–°ç«¹è–å®‰å®®"],
    "æ¡ƒåœ’/è‹—æ —": ["ç¦éš†å®®", "äº”ç¦å®®", "å¾©èˆˆè–èˆˆå®®", "å¤§æºªæ±èˆˆå®®", "å¤§æºªå¾©èˆˆå®®", "æ™¯ç¦å®®", "ç¦ä»å®®", "å…«å¾·è–ç‹å®®", "å¹³é®å»ºå®‰å®®", "å¤§æºªä»å’Œå®®", "é’åŸ”é’æ˜‡å®®", "ç‘æºå®®", "æŒ‡åš´å®®", "çŸ³æ©‹å¾©èˆˆå®®", "è§€éŸ³å¾©èˆˆå®®"],
    "å°ä¸­/å½°åŒ–": ["çƒæ—¥å»ºèˆˆå®®", "çƒæ—¥è–èˆˆå®®", "å°ä¸­å•Ÿèˆˆå®®", "å°ä¸­ç„éˆæ­¦è–å ‚", "å¤§é‡Œè–éš†å®®", "èŒ„æŠ•å¥‰å¤©å®®", "å››å¼µçŠé–‹æ¼³è–ç‹å»Ÿ", "å°ä¸­æƒ ä¾†å»Ÿ", "å½°åŒ–å•Ÿé †å®®", "å½°é‚‘å¨æƒ å»Ÿ", "å½°åŒ–èŠ¬åœ’é–‹æ¼³åºœ", "ç”°å°¾è–ç¥¿å ‚"],
    "å—æŠ•/é›²æ—": ["è‰å±¯é™³åºœå°‡è»å»Ÿ", "ç«¹å±±æ­¦å¾·å®®", "åé–“è–å¤©å®®", "åé–“å¤§åº„å¤§è³¢å®®", "æ–—å…­ç¦èˆˆå®®", "å¤å‘æ…ˆéˆå®®", "åŒ—æ¸¯æ˜­çƒˆå®®"],
    "å˜‰ç¾©/å°å—": ["å¤§æ—å®‰éœå®®", "é¹¿è‰æ¨¹å¾·å®®", "é–‹å…ƒä½›æ®¿", "æ¢…å±±å¨æƒ å®®", "æ–°ç‡ŸåŒæ¿Ÿå®®", "å–„åŒ–è¥¿è¡›é–‹å…ƒå®®", "å°å—å¸‚è–å®‰å®®", "æ­¸ä»å¿ é †å®®"],
    "é«˜é›„/å±æ±/å°æ±": ["é³³é‚‘é–‹æ¼³è–ç‹å»Ÿ", "ä¸­åº„æ…ˆè–å®®", "ç‡•å·¢èˆˆé¾å®®", "æ‰æ—å¨è–å»Ÿ", "èŒ„è£é®ç¦æ®¿", "å·¦ç‡Ÿæ…ˆå®‰å®®", "ä¹å¦‚è–ç‹å»Ÿ", "ç«¹ç”°å»ºå®‰å®®", "æ± ä¸Šå»ºå®‰å®®"],
    "èŠ±è“®/å®œè˜­": ["äºŒåŸå¨æƒ å»Ÿ", "ç¤æºªæ¼³ç¦å»Ÿ", "ç¤æºªæ°¸èˆˆå»Ÿ", "ç¤æºªé›†æƒ å»Ÿ", "ç¤æºªæ°¸è­·å»Ÿ", "ç¤æºªä¿å®‰å»Ÿ", "å£¯åœæ°¸é®å»Ÿ", "å£¯å…­é®å®‰å»Ÿ", "å£¯åœæ°¸æƒ å»Ÿ", "å£¯åœé®å®‰å»Ÿ", "æ±æ¸¯é®å®‰å®®", "ååŸ¤æŒ¯å®‰å»Ÿ", "æ–°ç¤¾é®å®‰å»Ÿ", "å®œè˜­éˆé®å»Ÿ", "å®œè˜­ä¸‰æ¸…å®®", "å®œè˜­å¸‚éˆæƒ å»Ÿ", "å®œè˜­å¸‚æ°¸é®å»Ÿ", "å“¡å±±ç‰é›²å®®", "ä¸‰æ˜Ÿæ˜­éˆå®®", "å†¬å±±è–ç¦å»Ÿ", "æ©„ç¤¾ç¦å®‰å®®", "ä¸‰å‰éˆæƒ å»Ÿ", "èŠ±è“®äº”å¤©å®®", "æ–°åŸé®å®‰å®®", "èŠ±è“®é–‹éˆå®®"]
  };

  // åœ°å€é¸æ“‡æ™‚æ›´æ–°å®®å»Ÿ
  document.getElementById('region').addEventListener('change', function() {
    const region = this.value;
    const templeSelect = document.getElementById('temple');
    templeSelect.innerHTML = '<option value="">è«‹é¸æ“‡å®®å»Ÿ</option>';
    
    if (region && templeData[region]) {
      templeData[region].forEach(temple => {
        const option = document.createElement('option');
        option.value = temple;
        option.textContent = temple;
        templeSelect.appendChild(option);
      });
    }
  });

  async function submitForm() {
    const name = document.getElementById('name').value.trim();
    const region = document.getElementById('region').value;
    const temple = document.getElementById('temple').value;
    
    if (!name || !region || !temple) {
      alert('è«‹å¡«å¯«å®Œæ•´è³‡æ–™ï¼');
      return;
    }

    // å¿«é€Ÿç”¢ç”ŸæŠ½çè™Ÿç¢¼
    let hash = 0;
    for (let i = 0; i < name.length; i++) {
      hash = ((hash << 5) - hash) + name.charCodeAt(i);
      hash = hash & hash;
    }
    const number = Math.abs(hash) % 999 + 1;
    
    // ç«‹å³é¡¯ç¤ºçµæœçµ¦ä½¿ç”¨è€…
    const result = document.getElementById('result');
    result.innerHTML = `
      <h3 style="text-align: center; color: #4caf50;">ğŸ‰ ç™»éŒ„æˆåŠŸï¼</h3>
      <div class="lottery-number">${number.toString().padStart(3, '0')}</div>
      <p><strong>å§“åï¼š</strong>${name}</p>
      <p><strong>åœ°å€ï¼š</strong>${region}</p>
      <p><strong>å®®å»Ÿï¼š</strong>${temple}</p>
      <p><strong>æ™‚é–“ï¼š</strong>${new Date().toLocaleString('zh-TW')}</p>
      <p style="color: #d32f2f; font-weight: bold; text-align: center;">ğŸ“¸ è«‹å‹™å¿…æˆªåœ–ä¿å­˜æŠ½çè™Ÿç¢¼ï¼</p>
      <div class="cloud-status">è³‡æ–™åŒæ­¥ä¸­...</div>
    `;
    result.style.display = 'block';
    
    // æ»¾å‹•åˆ°çµæœå€åŸŸ
    result.scrollIntoView({ behavior: 'smooth' });

    // èƒŒæ™¯å‚³é€åˆ°é›²ç«¯ï¼ˆä¸å½±éŸ¿ä½¿ç”¨è€…é«”é©—ï¼‰
    setTimeout(async () => {
      try {
        const submission = {
          lotteryNumber: number,
          name: name,
          region: region,
          temple: temple,
          timestamp: new Date().toLocaleString('zh-TW')
        };
        
        await fetch(CLOUD_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(submission)
        });
        
        // æ›´æ–°ç‹€æ…‹ç‚ºæˆåŠŸ
        document.querySelector('.cloud-status').textContent = 'âœ“ è³‡æ–™å·²åŒæ­¥åˆ°é›²ç«¯';
        document.querySelector('.cloud-status').style.color = '#4caf50';
        
      } catch (error) {
        // é›²ç«¯å¤±æ•—ä¹Ÿä¸å½±éŸ¿ä½¿ç”¨è€…
        document.querySelector('.cloud-status').textContent = 'âš  æœ¬åœ°å„²å­˜å®Œæˆï¼ˆé›²ç«¯åŒæ­¥ç¨å¾Œé€²è¡Œï¼‰';
        document.querySelector('.cloud-status').style.color = '#ff9800';
      }
    }, 100);
  }
  </script>
</body>
</html>